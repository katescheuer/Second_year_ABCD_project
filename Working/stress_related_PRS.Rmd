---
title: "Stress-related PRS"
output: html_document
date: "2024-02-12"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

setwd("C:/Users/Kate Scheuer/OneDrive - UW/Desktop/Lab/Second_year_ABCD_project/Working")

```

### Import data, load libraries

```{r import data, load libraries, echo=FALSE}

### load libraries ####
library(readxl)
library(tidyverse)
library(GENESIS)
library(lme4)
library(Matrix)
library(misty)
library(lmerTest)
library(moments)
library(robustlmm)

### avoid scientific notation ####
options(scipen=999) ## forces full display of results, all digits
# to change it back to scientific notation, use: options(scipen=0)


### import data ####

## ABCD data
demo <- read.csv("abcd_p_demo.csv",header=T) # demographics
meta <- read.csv("abcd_y_lt.csv",header=T) #site id, interview age
cbcl <- read.csv("mh_p_cbcl.csv",header=T) # cbcl
ksads_lifetime <- read.csv("ABCD_Baseline_T1_T2_T3_T4_KSADS_Lifetime_Diagnoses.csv") #lifetime ksads diagnoses

## federal poverty data from https://aspe.hhs.gov/topics/poverty-economic-mobility/poverty-guidelines
poverty_info <- read.csv("federal_poverty_info.csv",header=T)

## PRS 
prs_stress <- read.table("StressPRS_w_MHC.profile",header=T) #include all snps in mhc
prs_mdd <- read.table("MDD_PRS.profile",header=T)

## genetic relatedness matrices (GRMs)
all_grm <- readRDS(file = "ABCD_All_PCRel_grm_sparse.rda") # all ancestries
afr_grm <- readRDS(file = "ABCD_Afr_PCRel_grm_sparse.rda") # african ancestry
amadmix_grm <- readRDS(file = "ABCD_AmerAdmix_PCRel_grm_sparse.rda") # american admixed ancestry
eur_grm <- readRDS(file = "ABCD_Eur_PCRel_grm_sparse.rda") # european ancestry

## ancestry groupings
afr_gp <- read_xlsx("ABCD_RF_Afr_Grouping.xlsx")
amadmix_gp <- read_xlsx("ABCD_RF_AmerAdmix_Grouping.xlsx")
eur_gp <- read_xlsx("ABCD_RF_Eur_Grouping.xlsx")

```

### Group all like files into one data frame each, basic data cleaning

```{r group data, echo=FALSE}

### calculate income to needs ratio
income_df <- demo %>%
              select(c("src_subject_id","eventname",
                       "demo_roster_v2","demo_roster_v2_l",
                       "demo_roster_v2_refuse","demo_roster_v2_refuse_l",
                       "demo_comb_income_v2","demo_comb_income_v2_l")) %>%
              # combine items for income from baseline to yr 2 and yr 3+
              mutate(income_category = case_when(!is.na(demo_comb_income_v2) ~ demo_comb_income_v2,
                                        !is.na(demo_comb_income_v2_l) ~ demo_comb_income_v2_l
                                  )) %>%
              # for income replace 777 and 999 with NA
              mutate(income_category = ifelse(income_category %in% 
                                                c(777,999) , NA, income_category)) %>%
              # add column for middle value of income category (or upper for 10)
              mutate(income_val = case_when(income_category == 1 ~ 2499.5, # less than 5,000
                                            income_category == 2 ~ 8499.5, # 5,000 to 11,999
                                            income_category == 3 ~ 13999.5, # 12,000 to 15,999
                                            income_category == 4 ~ 20499.5, # 16,000 to 24,999
                                            income_category == 5 ~ 29999.5, # 25,000 to 34,999
                                            income_category == 6 ~ 42499.5, # 35,000 to 49,999
                                            income_category == 7 ~ 62499.5, # 50,000 to 74,999
                                            income_category == 8 ~ 87499.5, # 75,000 to 99,999
                                            income_category == 9 ~ 149999.5, # 100,000 to 199,999
                                            income_category == 10 ~ 200000 # 200,000 and greater
                                  )) %>%
              # combine items for household size from baseline to yr 2 and yr 3+
              mutate(household_size = case_when(demo_roster_v2_refuse %in% c(777,999) ~ NA,
                                                demo_roster_v2_refuse_l %in% c(777,999) ~ NA,
                                        !is.na(demo_roster_v2) ~ demo_roster_v2,
                                        !is.na(demo_roster_v2_l) ~ demo_roster_v2_l
                                  )) %>%
              # for household size replace unreasonable values with NA
              mutate(household_size = ifelse(household_size %in% 
                              c(-4, 0, 41, 43, 56, 60, 77, 110, 2300) , NA, household_size)) %>%
              # add year data was collected
              left_join(select(meta,c("src_subject_id","eventname","interview_date")),
                                    by=c("src_subject_id","eventname")) %>%
              mutate(year = as.integer(gsub("^.{1,6}","",interview_date))) %>%
              # add federal poverty line for given year and household size
              left_join(poverty_info,by=c("household_size","year")) %>%
              # calculate income to needs ratio
              mutate(income_to_needs = income_val/poverty_line)


## group all abcd data ####  
abcd_all <- demo %>%
              select(c("src_subject_id","eventname","demo_sex_v2",
                       "demo_gender_id_v2","demo_gender_id_v2_l")) %>%
              # to copy sex (asked only at baseline) to other years
              group_by(src_subject_id) %>%
              mutate(sex = first(demo_sex_v2)) %>%
              ungroup() %>%
              # only 12 subjects are intersex which is too small to analyze
              # so set to NA
              mutate(sex = if_else(sex==3,NA,sex)) %>%
              # combine items for gender from baseline to yr 2 and yr 3+
              mutate(gender = case_when(!is.na(demo_gender_id_v2) ~ demo_gender_id_v2,
                                        !is.na(demo_gender_id_v2_l) ~ demo_gender_id_v2_l
                                  )) %>%
              # for gender replace 777 and 999 with NA
              mutate(gender = ifelse(gender %in% c(777,999) , NA, gender)) %>%
              # add income to needs ratio
              left_join(income_df,by=c("src_subject_id","eventname")) %>%
              # add site and interview age
              left_join(select(meta,
                               c("src_subject_id","eventname",
                                 "site_id_l","interview_age")),
                        by=c("src_subject_id","eventname")) %>%
              rename(site = site_id_l,
                     age = interview_age) %>%
              # add cbcl scores
              left_join(select(cbcl,
                               c("src_subject_id","eventname",
                                 "cbcl_scr_syn_aggressive_t","cbcl_scr_syn_attention_t",
                                 "cbcl_scr_syn_anxdep_t","cbcl_scr_syn_external_t",
                                 "cbcl_scr_syn_internal_t","cbcl_scr_syn_rulebreak_t",
                                 "cbcl_scr_syn_social_t","cbcl_scr_syn_somatic_t",
                                 "cbcl_scr_syn_thought_t","cbcl_scr_syn_totprob_t",
                                 "cbcl_scr_syn_withdep_t")),
                        by=c("src_subject_id","eventname")) %>%
              rename(cbcl_agg = cbcl_scr_syn_aggressive_t,
                     cbcl_attn = cbcl_scr_syn_attention_t,
                     cbcl_anxdep = cbcl_scr_syn_anxdep_t,
                     cbcl_ext = cbcl_scr_syn_external_t,
                     cbcl_int = cbcl_scr_syn_internal_t,
                     cbcl_rule = cbcl_scr_syn_rulebreak_t,
                     cbcl_social = cbcl_scr_syn_social_t,
                     cbcl_somatic = cbcl_scr_syn_somatic_t,
                     cbcl_thought = cbcl_scr_syn_thought_t,
                     cbcl_total = cbcl_scr_syn_totprob_t,
                     cbcl_withdep = cbcl_scr_syn_withdep_t) %>%
              # add lifetime ksads scores
              left_join(select(ksads_lifetime,
                               c("src_subject_id","eventname",
                                 "lifetime_adhd","umbrella_anxiety_disorder",
                                 "lifetime_mdd","lifetime_ptsd")),
                        by=c("src_subject_id","eventname")) %>%
              rename(adhd = lifetime_adhd,
                     anxiety = umbrella_anxiety_disorder,
                     mdd = lifetime_mdd,
                     ptsd = lifetime_ptsd)
              

## group all prs data ####
prs_all <- prs_stress %>%
            #rename stress prs column to indicate score is for stress
            rename(prs_stress = SCORESUM) %>%
            select(IID,prs_stress) %>%
            left_join(select(prs_mdd,c("IID","SCORESUM")),
                      by=c("IID")) %>%
            rename(prs_mdd = SCORESUM) %>%
            #remove first 10 char so subject id as in abcd
            mutate(src_subject_id = gsub("^.{1,10}", "", IID)) %>%
            select(c(src_subject_id,prs_stress,prs_mdd))

## make categorical ancestry groups ####
afr_gp <- afr_gp %>% mutate(ancestry="Afr")
amadmix_gp <- amadmix_gp %>% mutate(ancestry="AmAdmix")
eur_gp <- eur_gp %>% mutate(ancestry="Eur")
ancestry_gp_all <- bind_rows(afr_gp,amadmix_gp,eur_gp) %>%
                      select("subjectkey","ancestry","V1","V2","V3","V4","V5","V6","V7","V8") %>%
                      rename(src_subject_id = subjectkey)

# rename grms so names are consistent with abcd names
#if remove first 10 char from rownames in grm then = subject id
rownames(all_grm) <- gsub("^.{1,10}","",rownames(all_grm)) 
colnames(all_grm) <- gsub("^.{1,10}","",colnames(all_grm))
rownames(afr_grm) <- gsub("^.{1,10}","",rownames(afr_grm))
colnames(afr_grm) <- gsub("^.{1,10}","",colnames(afr_grm))
rownames(amadmix_grm) <- gsub("^.{1,10}","",rownames(amadmix_grm))
colnames(amadmix_grm) <- gsub("^.{1,10}","",colnames(amadmix_grm))
rownames(eur_grm) <- gsub("^.{1,10}","",rownames(eur_grm))
colnames(eur_grm) <- gsub("^.{1,10}","",colnames(eur_grm))

### combine all data except grms ####
data_all <- abcd_all %>%
              left_join(prs_all, by="src_subject_id") %>%
              left_join(ancestry_gp_all, by="src_subject_id") %>%
              #remove subjects without ancestry information
              filter(!is.na(ancestry)) %>%
              #Z-score  PRS based on ancestry
              group_by(ancestry) %>%
              mutate(Zprs_stress = as.numeric(scale(prs_stress, scale=TRUE))) %>%
              group_by(ancestry) %>%
              mutate(Zprs_mdd = as.numeric(scale(prs_mdd, scale=TRUE))) %>%
              #keep only relevant columns
              select(c(src_subject_id,eventname,site,ancestry,
                       sex,gender,income_to_needs,age,
                       Zprs_stress,Zprs_mdd,
                       cbcl_total,cbcl_ext,cbcl_int,
                       cbcl_agg,cbcl_attn,cbcl_anxdep,
                       cbcl_rule,cbcl_social,cbcl_somatic,
                       cbcl_thought,cbcl_withdep,
                       adhd,anxiety,mdd,ptsd,
                       V1,V2,V3,V4,V5,V6,V7,V8
                       ))

### dummy code categorical variables
data_all <- data_all %>%
            #dummy coding
            mutate(sex_dum_cisf = case_when(sex == 1 ~ 0,
                                            sex == 2 ~ 1)) %>%
            #effect coding - different betas but same pvals
            mutate(sex_eff_cisf = case_when(sex == 1 ~ -1, 
                                            sex == 2 ~ 1)) %>%
            #cluster mean centering - slightly different betas and pvals
            mutate(sex_cmc_cisf = as.numeric(center(sex_eff_cisf, 
                             type="CWC", cluster = site))) %>%
            mutate(Zprs_stress_cmc = as.numeric(center(Zprs_stress,type="CWC",cluster=site))) %>%
            mutate(Zprs_mdd_cmc = as.numeric(center(Zprs_mdd,type="CWC",cluster=site))) %>%
            mutate(age_cmc = as.numeric(center(age,type="CWC",cluster=site))) %>%
            #Z score continuous variables (already done for prs by ancestry)
            mutate(age_zcmc = as.numeric(scale(age_cmc, scale=TRUE)))




```

### Separate data based on collection date

``` {separate data based on collection date, r}

baseline_data <- data_all %>% filter(eventname == "baseline_year_1_arm_1")
yr1_data <- data_all %>% filter(eventname == "1_year_follow_up_y_arm_1")
yr2_data <- data_all %>% filter(eventname == "2_year_follow_up_y_arm_1")
yr3_data <- data_all %>% filter(eventname == "3_year_follow_up_y_arm_1")
yr4_data <- data_all %>% filter(eventname == "4_year_follow_up_y_arm_1")

```

### Reorder data so matches grm

```{reorder data so matches grm, r}

### All ancestries ####
all_grm_for_yr <- all_grm[which(rownames(all_grm) %in% yr4_data$src_subject_id),]
all_grm_for_yr <- all_grm_for_yr[,which(colnames(all_grm_for_yr) %in% yr4_data$src_subject_id)]
row_indices_All <- match(yr4_data$src_subject_id,rownames(all_grm_for_yr)) 
all_grm_sparse_subsetted <- all_grm_for_yr[row_indices_All, row_indices_All]
all_yr4_data_reordered <- yr4_data[match(colnames(all_grm_sparse_subsetted),yr4_data$src_subject_id),]
all_yr4_data_reordered <- all_yr4_data_reordered %>% column_to_rownames(var="src_subject_id")

### African ancestry ####
afr_grm_for_yr <- afr_grm[which(rownames(afr_grm) %in% yr4_data$src_subject_id),]
afr_grm_for_yr <- afr_grm_for_yr[,which(colnames(afr_grm_for_yr) %in% yr4_data$src_subject_id)]
row_indices_All <- match(yr4_data$src_subject_id,rownames(afr_grm_for_yr)) 
afr_yr4_data <- yr4_data %>% filter(ancestry=="Afr")
row_indices_All <- match(afr_yr4_data$src_subject_id,rownames(afr_grm_for_yr))
afr_grm_sparse_subsetted <- afr_grm_for_yr[row_indices_All, row_indices_All]
afr_yr4_data_reordered <- afr_yr4_data[match(colnames(afr_grm_sparse_subsetted),
                                                       afr_yr4_data$src_subject_id),]
afr_yr4_data_reordered <- afr_yr4_data_reordered %>% column_to_rownames(var="src_subject_id")

### American admixed ancestry ####
amadmix_grm_for_yr <- amadmix_grm[which(rownames(amadmix_grm) %in% yr4_data$src_subject_id),]
amadmix_grm_for_yr <- amadmix_grm_for_yr[,which(colnames(amadmix_grm_for_yr) %in% yr4_data$src_subject_id)]
row_indices_All <- match(yr4_data$src_subject_id,rownames(amadmix_grm_for_yr)) 
amadmix_yr4_data <- yr4_data %>% filter(ancestry=="AmAdmix")
row_indices_All <- match(amadmix_yr4_data$src_subject_id,rownames(amadmix_grm_for_yr))
amadmix_grm_sparse_subsetted <- amadmix_grm_for_yr[row_indices_All, row_indices_All]
amadmix_yr4_data_reordered <- amadmix_yr4_data[match(colnames(amadmix_grm_sparse_subsetted),
                                                               amadmix_yr4_data$src_subject_id),]
amadmix_yr4_data_reordered <- amadmix_yr4_data_reordered %>% column_to_rownames(var="src_subject_id")

### European ancestry ####
eur_grm_for_yr <- eur_grm[which(rownames(eur_grm) %in% yr4_data$src_subject_id),]
eur_grm_for_yr <- eur_grm_for_yr[,which(colnames(eur_grm_for_yr) %in% yr4_data$src_subject_id)]
eur_yr4_data <- yr4_data %>% filter(ancestry=="Eur")
row_indices_All <- match(eur_yr4_data$src_subject_id,rownames(eur_grm_for_yr))
eur_grm_sparse_subsetted <- eur_grm_for_yr[row_indices_All, row_indices_All]
eur_yr4_data_reordered <- eur_yr4_data[match(colnames(eur_grm_sparse_subsetted),
                                                       eur_yr4_data$src_subject_id),]
eur_yr4_data_reordered <- eur_yr4_data_reordered %>% column_to_rownames(var="src_subject_id")

```

### Make matrices for site

``` {make matrices for site, r}

#for all ancestries, make true/false covariance matrix for site
all_site_covmat_string <- outer(all_yr4_data_reordered$site, all_yr4_data_reordered$site, "==")
all_site_covmat <- apply(all_site_covmat_string, 2, as.numeric)
dimnames(all_site_covmat) <- dimnames(all_grm_sparse_subsetted)

#for eur ancestry, make true/false covariance matrix for site
eur_site_covmat_string <- outer(eur_yr4_data_reordered$site, eur_yr4_data_reordered$site, "==")
eur_site_covmat <- apply(eur_site_covmat_string, 2, as.numeric)
dimnames(eur_site_covmat) <- dimnames(eur_grm_sparse_subsetted)

#for afr ancestry, make true/false covariance matrix for site
afr_site_covmat_string <- outer(afr_yr4_data_reordered$site, afr_yr4_data_reordered$site, "==")
afr_site_covmat <- apply(afr_site_covmat_string, 2, as.numeric)
dimnames(afr_site_covmat) <- dimnames(afr_grm_sparse_subsetted)

#for amadmix ancestry, make true/false covariance matrix for site
amadmix_site_covmat_string <- outer(amadmix_yr4_data_reordered$site, 
                                    amadmix_yr4_data_reordered$site, "==")
amadmix_site_covmat <- apply(amadmix_site_covmat_string, 2, as.numeric)
dimnames(amadmix_site_covmat) <- dimnames(amadmix_grm_sparse_subsetted)

```

### Stress PRS, eur ancestry: cbcl or ksads ~ stress prs + sex + age + ancestry PCs

``` {stress PRS, eur ancestry: cbcl or ksads ~ stress prs + sex + age + ancestry PCs, r}

lm_eur_stressprs_total <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_total", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_ext <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_ext", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_int <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_int", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_agg <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_agg", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_attn <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_attn", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_anxdep <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_anxdep", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_rule <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_rule", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_social <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_social", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_somatic <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_somatic", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_thought <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_thought", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_stressprs_withdep <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_withdep", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)

lm_eur_stressprs_adhd <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "adhd", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_eur_stressprs_anxiety <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "anxiety", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_eur_stressprs_mdd <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "mdd", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_eur_stressprs_ptsd <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "ptsd", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)

### see fixed effect results
round(lm_eur_stressprs_total$fixef,10)
round(lm_eur_stressprs_ext$fixef,10)
round(lm_eur_stressprs_int$fixef,10)
round(lm_eur_stressprs_agg$fixef,10)
round(lm_eur_stressprs_attn$fixef,10)
round(lm_eur_stressprs_anxdep$fixef,10)
round(lm_eur_stressprs_rule$fixef,10)
round(lm_eur_stressprs_social$fixef,10)
round(lm_eur_stressprs_somatic$fixef,10)
round(lm_eur_stressprs_thought$fixef,10)
round(lm_eur_stressprs_withdep$fixef,10)
round(lm_eur_stressprs_adhd$fixef,10)
round(lm_eur_stressprs_anxiety$fixef,10)
round(lm_eur_stressprs_mdd$fixef,10)
round(lm_eur_stressprs_ptsd$fixef,10)

```


### MDD PRS, eur ancestry: cbcl or ksads ~ mdd prs + sex + age + ancestry PCs

``` {mdd PRS, eur ancestry: cbcl or ksads ~ mdd prs + sex + age + ancestry PCs, r}

lm_eur_mddprs_total <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_total", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_ext <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_ext", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_int <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_int", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_agg <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_agg", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_attn <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_attn", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_anxdep <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_anxdep", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_rule <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_rule", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_social <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_social", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_somatic <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_somatic", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_thought <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_thought", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_eur_mddprs_withdep <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "cbcl_withdep", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)

lm_eur_mddprs_adhd <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "adhd", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_eur_mddprs_anxiety <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "anxiety", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_eur_mddprs_mdd <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "mdd", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_eur_mddprs_ptsd <- fitNullModel(eur_yr4_data_reordered, 
                                  outcome = "ptsd", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = eur_grm_sparse_subsetted,
                                                 site = eur_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)

### see fixed effect results
round(lm_eur_mddprs_total$fixef,10)
round(lm_eur_mddprs_ext$fixef,10)
round(lm_eur_mddprs_int$fixef,10)
round(lm_eur_mddprs_agg$fixef,10)
round(lm_eur_mddprs_attn$fixef,10)
round(lm_eur_mddprs_anxdep$fixef,10)
round(lm_eur_mddprs_rule$fixef,10)
round(lm_eur_mddprs_social$fixef,10)
round(lm_eur_mddprs_somatic$fixef,10)
round(lm_eur_mddprs_thought$fixef,10)
round(lm_eur_mddprs_withdep$fixef,10)
round(lm_eur_mddprs_adhd$fixef,10)
round(lm_eur_mddprs_anxiety$fixef,10)
round(lm_eur_mddprs_mdd$fixef,10)
round(lm_eur_mddprs_ptsd$fixef,10)

```


### Stress PRS, afr ancestry: cbcl or ksads ~ stress prs + sex + age + ancestry PCs

``` {stress PRS, afr ancestry: cbcl or ksads ~ stress prs + sex + age + ancestry PCs, r}

lm_afr_stressprs_total <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_total", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_ext <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_ext", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_int <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_int", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_agg <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_agg", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_attn <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_attn", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_anxdep <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_anxdep", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_rule <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_rule", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_social <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_social", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_somatic <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_somatic", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_thought <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_thought", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_stressprs_withdep <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_withdep", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)

lm_afr_stressprs_adhd <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "adhd", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_afr_stressprs_anxiety <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "anxiety", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_afr_stressprs_mdd <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "mdd", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_afr_stressprs_ptsd <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "ptsd", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)

### see fixed effect results
round(lm_afr_stressprs_total$fixef,10)
round(lm_afr_stressprs_ext$fixef,10)
round(lm_afr_stressprs_int$fixef,10)
round(lm_afr_stressprs_agg$fixef,10)
round(lm_afr_stressprs_attn$fixef,10)
round(lm_afr_stressprs_anxdep$fixef,10)
round(lm_afr_stressprs_rule$fixef,10)
round(lm_afr_stressprs_social$fixef,10)
round(lm_afr_stressprs_somatic$fixef,10)
round(lm_afr_stressprs_thought$fixef,10)
round(lm_afr_stressprs_withdep$fixef,10)
round(lm_afr_stressprs_adhd$fixef,10)
round(lm_afr_stressprs_anxiety$fixef,10)
round(lm_afr_stressprs_mdd$fixef,10)
round(lm_afr_stressprs_ptsd$fixef,10)

```


### MDD PRS, afr ancestry: cbcl or ksads ~ mdd prs + sex + age + ancestry PCs

``` {mdd PRS, afr ancestry: cbcl or ksads ~ mdd prs + sex + age + ancestry PCs, r}

lm_afr_mddprs_total <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_total", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_ext <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_ext", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_int <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_int", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_agg <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_agg", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_attn <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_attn", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_anxdep <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_anxdep", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_rule <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_rule", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_social <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_social", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_somatic <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_somatic", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_thought <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_thought", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_afr_mddprs_withdep <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "cbcl_withdep", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)

lm_afr_mddprs_adhd <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "adhd", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_afr_mddprs_anxiety <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "anxiety", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_afr_mddprs_mdd <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "mdd", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_afr_mddprs_ptsd <- fitNullModel(afr_yr4_data_reordered, 
                                  outcome = "ptsd", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = afr_grm_sparse_subsetted,
                                                 site = afr_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)

### see fixed effect results
round(lm_afr_mddprs_total$fixef,10)
round(lm_afr_mddprs_ext$fixef,10)
round(lm_afr_mddprs_int$fixef,10)
round(lm_afr_mddprs_agg$fixef,10)
round(lm_afr_mddprs_attn$fixef,10)
round(lm_afr_mddprs_anxdep$fixef,10)
round(lm_afr_mddprs_rule$fixef,10)
round(lm_afr_mddprs_social$fixef,10)
round(lm_afr_mddprs_somatic$fixef,10)
round(lm_afr_mddprs_thought$fixef,10)
round(lm_afr_mddprs_withdep$fixef,10)
round(lm_afr_mddprs_adhd$fixef,10)
round(lm_afr_mddprs_anxiety$fixef,10)
round(lm_afr_mddprs_mdd$fixef,10)
round(lm_afr_mddprs_ptsd$fixef,10)

```


### Stress PRS, amadmix ancestry: cbcl or ksads ~ stress prs + sex + age + ancestry PCs

``` {stress PRS, amadmix ancestry: cbcl or ksads ~ stress prs + sex + age + ancestry PCs, r}

lm_amadmix_stressprs_total <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_total", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_ext <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_ext", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_int <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_int", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_agg <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_agg", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_attn <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_attn", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_anxdep <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_anxdep", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_rule <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_rule", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_social <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_social", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_somatic <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_somatic", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_thought <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_thought", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_stressprs_withdep <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_withdep", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)

lm_amadmix_stressprs_adhd <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "adhd", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_amadmix_stressprs_anxiety <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "anxiety", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_amadmix_stressprs_mdd <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "mdd", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_amadmix_stressprs_ptsd <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "ptsd", 
                                  covars = c("Zprs_stress_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)

### see fixed effect results
round(lm_amadmix_stressprs_total$fixef,10)
round(lm_amadmix_stressprs_ext$fixef,10)
round(lm_amadmix_stressprs_int$fixef,10)
round(lm_amadmix_stressprs_agg$fixef,10)
round(lm_amadmix_stressprs_attn$fixef,10)
round(lm_amadmix_stressprs_anxdep$fixef,10)
round(lm_amadmix_stressprs_rule$fixef,10)
round(lm_amadmix_stressprs_social$fixef,10)
round(lm_amadmix_stressprs_somatic$fixef,10)
round(lm_amadmix_stressprs_thought$fixef,10)
round(lm_amadmix_stressprs_withdep$fixef,10)
round(lm_amadmix_stressprs_adhd$fixef,10)
round(lm_amadmix_stressprs_anxiety$fixef,10)
round(lm_amadmix_stressprs_mdd$fixef,10)
round(lm_amadmix_stressprs_ptsd$fixef,10)

```


### MDD PRS, amadmix ancestry: cbcl or ksads ~ mdd prs + sex + age + ancestry PCs

``` {mdd PRS, amadmix ancestry: cbcl or ksads ~ mdd prs + sex + age + ancestry PCs, r}

lm_amadmix_mddprs_total <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_total", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_ext <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_ext", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_int <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_int", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_agg <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_agg", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_attn <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_attn", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_anxdep <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_anxdep", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_rule <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_rule", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_social <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_social", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_somatic <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_somatic", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_thought <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_thought", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)
lm_amadmix_mddprs_withdep <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "cbcl_withdep", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "gaussian",
                                  verbose = TRUE)

lm_amadmix_mddprs_adhd <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "adhd", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_amadmix_mddprs_anxiety <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "anxiety", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_amadmix_mddprs_mdd <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "mdd", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)
lm_amadmix_mddprs_ptsd <- fitNullModel(amadmix_yr4_data_reordered, 
                                  outcome = "ptsd", 
                                  covars = c("Zprs_mdd_cmc", "sex_cmc_cisf", "age_zcmc", paste0("V", 1:8)), 
                                  cov.mat = list(kinship = amadmix_grm_sparse_subsetted,
                                                 site = amadmix_site_covmat),
                                  family = "binomial",
                                  verbose = TRUE)

### see fixed effect results
round(lm_amadmix_mddprs_total$fixef,10)
round(lm_amadmix_mddprs_ext$fixef,10)
round(lm_amadmix_mddprs_int$fixef,10)
round(lm_amadmix_mddprs_agg$fixef,10)
round(lm_amadmix_mddprs_attn$fixef,10)
round(lm_amadmix_mddprs_anxdep$fixef,10)
round(lm_amadmix_mddprs_rule$fixef,10)
round(lm_amadmix_mddprs_social$fixef,10)
round(lm_amadmix_mddprs_somatic$fixef,10)
round(lm_amadmix_mddprs_thought$fixef,10)
round(lm_amadmix_mddprs_withdep$fixef,10)
round(lm_amadmix_mddprs_adhd$fixef,10)
round(lm_amadmix_mddprs_anxiety$fixef,10)
round(lm_amadmix_mddprs_mdd$fixef,10)
round(lm_amadmix_mddprs_ptsd$fixef,10)

```


